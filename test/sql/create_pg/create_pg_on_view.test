

require duckpgq

statement ok
CREATE TABLE vdata(id TEXT PRIMARY KEY);

statement ok
CREATE VIEW v AS SELECT * FROM vdata;

statement ok
CREATE TABLE w(id TEXT PRIMARY KEY);

statement ok
CREATE TABLE v_w(v_id TEXT, w_id TEXT);

statement ok
-CREATE PROPERTY GRAPH g1
  VERTEX TABLES (v, w)

  EDGE TABLES (
    v_w SOURCE KEY (v_id) REFERENCES v (id)
        DESTINATION KEY (w_id) REFERENCES w (id)
    LABEL hasW
  );